package main

import (
	"encoding/csv"
	"os"

	"github.com/mitchellh/go-homedir"

	"github.com/anchore/vulnerability-data-tools/cve-text-analyzer/internal/util"
)

func readFirstColumnFromCSVFile(csvFile string) []string {
	var cves []string
	rdr := csv.NewReader(util.Get(os.Open(util.Get(homedir.Expand(csvFile)))))
	_, _ = rdr.Read() // skip headers
	for row, err := rdr.Read(); err == nil; row, err = rdr.Read() {
		cves = append(cves, row[0])
	}
	return cves
}
