package search

func weightByIDTerms(l Indexes, factor float64) Indexes {
	for p := range l.allProducts {
		for term, weight := range p.Weights {
			if skipTerms.Has(term) {
				// don't weight skipped Terms higher
				continue
			}
			cpeTerms := parseCpeTerms(p.Cpe)
			if cpeTerms.Has(term) {
				p.Weights[term] = weight * factor * cpeTerms[term]
			}
		}
	}

	return l
}
