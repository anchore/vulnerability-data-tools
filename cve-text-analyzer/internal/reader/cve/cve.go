package cve

import (
	"github.com/anchore/grype-db/pkg/provider/unmarshal/nvd/cvss31"
)

type Version struct {
	Version     string `json:"version"`
	VersionType string `json:"versionType"`
	LessThan    string `json:"lessThan"`
}

type Affected struct {
	Vendor      string    `json:"vendor"`
	Product     string    `json:"product"`
	PackageName string    `json:"packageName"`
	Versions    []Version `json:"versions"`
	Cpes        []string  `json:"cpes"`
}

type Metadata struct {
	ID    string `json:"cveId"`
	State string `json:"state"`
}

type Reference struct {
	Url string `json:"url"`
}

type Text struct {
	Lang  string `json:"lang"`
	Value string `json:"value"`
}

type Metrics struct {
	cvss31.Cvss31 `json:"cvssV3_1"`
}

type Cna struct {
	Affected     []Affected  `json:"affected"`
	References   []Reference `json:"references"`
	Descriptions []Text      `json:"descriptions"`
	Metrics      []Metrics   `json:"metrics"`
}

type Containers struct {
	Cna Cna `json:"cna"`
}

type Record struct {
	Metadata   Metadata   `json:"cveMetadata"`
	Containers Containers `json:"containers"`
}
