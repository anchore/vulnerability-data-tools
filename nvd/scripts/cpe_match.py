import json
import uuid

namespace = uuid.uuid5(uuid.NAMESPACE_URL, "https://github.com/anchore/nvd-data-overrides")

def generate_match_criteria_id(match_criteria: dict) -> uuid.UUID:
    """
    Creates a stable UUID for a given set of match criteria.  If we find out exactly how the NVD 
    generation works then in theory we should be able to exactly match any of their existing ids, 
    but I have not found any documentation around that so far.  This will ensure they at least 
    match across the override dataset.  We are not using the criteriaMatchId for anything, but others 
    might so we'll at least make them non-random  
    """
    return uuid.uuid5(namespace, json.dumps(match_criteria, sort_keys=True))